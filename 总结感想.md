# 总结感想

本感想以随笔的形式，基本上是想到哪写到哪。

## 感想

本学期的实验写着还是蛮爽的，因为从头到尾基本都是自己设计的，做完之后很有成就感。但是美中不足的是自己初次设计的架构终究是比较幼稚，在兼容性、成熟性和扩展性上都存在一些问题。

我的编译器经历过一次重构。在此先按下重构之前的不谈，我重构之后的编译器的时间分配大概如下：

* 词法分析：一晚上
* 语法分析：一天
* 错误处理和 PCode：一天
* llvm：四天
* MIPS：一天半
* 优化：1h（最后实在是没时间了，只能做一些力所能及的优化）

虽然优化只做了 1h 但是因为写过解释器，通过应用解释器成功将一个点大幅优化，最后擦边蓟县进入竞速前五十，可喜可贺可喜可贺。

个人感觉 llvm 的难度颇高。虽然可以参考 llvm 的架构设计 SSA，但是 llvm 整体的思维难度和实现难度都过大。学习思考 llvm 的过程大概占了整个编译实验的 20% 左右。而且 llvm 架构对于优化确实很有帮助，但是若不做很多优化，那么 llvm 纯粹是一个负优化。

从中端翻译到后端的过程很丝滑，写起来很舒服。使用线性扫描寄存器分配法分配得也很舒服。

此外助教老师都十分温柔！喜欢！

感觉编译理论和实验的联系还是很密切的，特别是代码优化那部分（虽然我没有做优化）。

## 建议

教程依然有改进的空间。此外辅助测试库可以继续加强。
